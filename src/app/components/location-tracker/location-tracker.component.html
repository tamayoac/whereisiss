<section class="relative mx-auto max-w-6xl px-4 lg:px-0 text-slate-100 space-y-6">
  <div class="absolute inset-0 -z-10 bg-[radial-gradient(circle_at_top_left,_rgba(34,197,94,0.05),_transparent_35%),_radial-gradient(circle_at_bottom_right,_rgba(59,130,246,0.04),_transparent_40%)]"></div>

  <div class="flex flex-wrap items-center justify-between gap-3">
    <div class="space-y-1">
      <p class="text-xs uppercase tracking-[0.18em] text-zinc-500">Live telemetry</p>
      <h2 class="text-2xl font-semibold leading-tight">Satellite Tracker</h2>
      <p class="text-sm text-zinc-500">Real-time positions via N2YO. Minimal space theme.</p>
    </div>
    <div class="flex items-center gap-2 rounded-full bg-emerald-500/10 px-3 py-1 text-xs font-medium text-emerald-300">
      <span class="h-2 w-2 rounded-full bg-emerald-400 opacity-90 animate-pulse"></span>
      {{ satelliteOptions.length }} satellites
    </div>
  </div>

  <div class="grid gap-6 lg:grid-cols-[1.5fr_1fr]">
    <div class="overflow-hidden rounded-3xl bg-black/70 shadow-[0_10px_40px_rgba(0,0,0,0.35)]">
      <div id="map" class="mapbox-container h-[420px] w-full"></div>
    </div>

    <div class="rounded-3xl bg-black/70 p-4 lg:p-5 flex flex-col gap-4 shadow-[0_10px_40px_rgba(0,0,0,0.35)]">
      <!-- Satellite selector -->
      <div class="space-y-2">
        <div class="flex items-center justify-between">
          <label class="text-xs text-zinc-500">Select satellite</label>
          <span class="text-[11px] text-zinc-600">Click to focus</span>
        </div>
        <div class="flex flex-wrap gap-2">
          <ng-container *ngFor="let option of satelliteOptions">
            <button
              (click)="selectSatellite(option.id)"
              [class.ring-2]="(selectedSatelliteId$ | async) === option.id"
              [class.ring-indigo-400]="(selectedSatelliteId$ | async) === option.id"
              class="flex items-center gap-1.5 px-2.5 py-1.5 rounded-xl bg-neutral-900/80 text-xs text-slate-200 hover:bg-neutral-800 transition-colors"
            >
              <span>{{ getSatelliteIcon(option) }}</span>
              <span class="truncate max-w-[140px]">{{ option.name }}</span>
            </button>
          </ng-container>
        </div>
      </div>

      <!-- Selected satellite metrics -->
      <ng-container *ngIf="selectedSatellite$ | async as sat; else loading">
        <div class="flex items-center justify-between">
          <h3 class="text-sm font-semibold text-slate-100">{{ sat.name }}</h3>
          <span class="text-xs text-zinc-500">UTC</span>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="rounded-2xl bg-neutral-900/80 p-3">
            <p class="text-xs text-zinc-500">Latitude</p>
            <p class="text-base font-semibold text-slate-50">{{ sat.latitude | number:'1.2-2' }}°</p>
          </div>
          <div class="rounded-2xl bg-neutral-900/80 p-3">
            <p class="text-xs text-zinc-500">Longitude</p>
            <p class="text-base font-semibold text-slate-50">{{ sat.longitude | number:'1.2-2' }}°</p>
          </div>
          <div class="rounded-2xl bg-neutral-900/80 p-3">
            <p class="text-xs text-zinc-500">Altitude</p>
            <p class="text-base font-semibold text-slate-50">{{ sat.altitude | number:'1.2-2' }} km</p>
          </div>
          <div class="rounded-2xl bg-neutral-900/80 p-3">
            <p class="text-xs text-zinc-500">Status</p>
            <p class="text-base font-semibold" [class.text-amber-400]="sat.eclipsed" [class.text-emerald-400]="!sat.eclipsed">
              {{ sat.eclipsed ? 'In shadow' : 'Sunlit' }}
            </p>
          </div>
          <div class="rounded-2xl bg-neutral-900/80 p-3 col-span-2">
            <p class="text-xs text-zinc-500">Last update</p>
            <p class="text-sm font-semibold text-slate-50">
              {{ convertTimestampToDate(sat.timestamp) | date:'medium':'UTC' }}
            </p>
          </div>
        </div>

        <!-- Live stream (ISS only) -->
        <ng-container *ngIf="sat.id === 25544">
          <div class="rounded-2xl bg-neutral-950 overflow-hidden">
            <iframe
              width="100%"
              class="block w-full"
              style="aspect-ratio: 16 / 9;"
              [src]="videoUrl"
              title="ISS External HD Camera"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
            <p class="px-3 py-2 text-[11px] text-slate-500">
              NASA external HD camera stream. May be temporarily unavailable.
            </p>
          </div>
        </ng-container>
      </ng-container>

      <ng-template #loading>
        <div class="space-y-2 text-sm text-zinc-500">
          <p>Fetching satellite positions...</p>
          <p class="text-xs text-slate-600">Connecting to N2YO API.</p>
        </div>
      </ng-template>
    </div>
  </div>
</section>
